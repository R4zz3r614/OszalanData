{"name":"Würfelpool","type":"script","author":"NdAjpNq64LjrLPB8","img":"icons/svg/d20-highlight.svg","scope":"global","command":"main()\n\nasync function main(){\n\n    let dialogTemplate = `\n    <div style=\"display:flex\">\n    <span style=\"flex:1\">Wähle die Anzahl der Würfel im Pool: <input  id=\"mod\" type=\"number\" style=\"width:50px;\" value=0 /></span>\n    </br>\n    </br>\n    </div>\n  `\n\n    let newDialog = new Dialog({\n        title: \"Würfelpool\",\n        content: dialogTemplate,\n        buttons: {\n            roll: {\n                label: \"Würfeln\",\n                callback: (html) => {\n                    let modifier = html.find(\"#mod\")[0].value;\n                    let newRollString = `${modifier}d10x,cs>=6`\n                    new Roll(newRollString).toMessage();\n                }\n            },\n        },\n    });\n    newDialog.render(true);\n}","folder":null,"sort":0,"permission":{"default":0,"NdAjpNq64LjrLPB8":3},"flags":{"core":{"sourceId":"Macro.hGYeCyUhSCeaIBw9"}},"_id":"k5nntScyvLfu6XAJ"}
{"name":"Heilungselixier_macro","type":"script","author":"NdAjpNq64LjrLPB8","img":"icons/consumables/potions/bottle-bulb-corked-glowing-red.webp","scope":"global","command":"main()\n\nasync function main() {\n   \n    //überprüfung ob genua ein Token ausgewählt wurde\n    if (canvas.tokens.controlled.length != 1){\n        ui.notifications.error(\"Bitte wähle ein Token aus\")\n        return;\n    }\n\n    //definiert den ausgewählten Token als actor\n    let actor = canvas.tokens.controlled[0].actor\n    \n    //überprüft ob der Actor eine Heilungselixier besitzt\n    let Heilungselixier = actor.items.find(item => item.data.name == \"Heilungselixier\")\n    if (Heilungselixier == null || Heilungselixier == undefined) {\n        ui.notifications.error(\"Keine Heilungselixiere übrig\")\n        return;\n    }\n\n    //verringert die Anzahl der heilungselixiere im Inventar um 1\n    await Heilungselixier.update({ \"data.quantity\": Heilungselixier.data.data.quantity - 1 })\n\n    //entfernt das letzte Elixier aus dem Inventar\n    if (Heilungselixier.data.data.quantity < 1) {\n        Heilungselixier.delete();\n    }\n\n    //berechnet die Heilung anhand eines Wurfs und der Stärke des Elixiers\n    let heal = Heilungselixier.data.data.attributes.heal.value\n    let newRollString = `${heal}d10x`\n    let r = new Roll(newRollString);\n\n    //gibt die Heilung als Chatmessage aus\n    await r.toMessage();\n    \n    //passt die Lebenspunte des Actors an\n    let newHealth = actor.data.data.health.value + r.total\n    if (newHealth > actor.data.data.health.max) {\n        newHealth = actor.data.data.health.max\n    }\n\n    actor.update({ \"data.health.value\": newHealth });\n}","folder":null,"sort":0,"permission":{"default":0,"NdAjpNq64LjrLPB8":3},"flags":{"core":{"sourceId":"Macro.00UHd1LUEjJ8rBRr"}},"_id":"wGHIAJEsxiMSm6FZ"}
{"name":"Schaden","type":"script","author":"NdAjpNq64LjrLPB8","img":"icons/magic/fire/barrier-wall-flame-ring-blue.webp","scope":"global","command":"main()\n\nasync function main() {\n\n    // Get Target\n    let targets = Array.from(game.user.targets)\n    console.log(targets.length)\n\n    if (targets.length == 0) {\n        ui.notifications.error(\"Bitte wähle Ziele aus\")\n        return;\n    }\n\n    let dialogTemplate = `\n    <div style=\"display:flex\">\n    <span style=\"flex:1\">Trage den Schaden ein: <input  id=\"dmg\" type=\"number\" style=\"width:50px;\" value=0 /></span>\n    </br>\n    </br>\n    </div>\n  `\n\n    let newDialog = new Dialog({\n        title: \"Würfelpool\",\n        content: dialogTemplate,\n        buttons: {\n            roll: {\n                label: \"Würfeln\",\n                callback: (html) => {\n                    let dmg = html.find(\"#dmg\")[0].value;\n                    let newHealth = 0\n                    for (let i = 0; i < targets.length; i++){\n                        console.log(i)\n                        newHealth = targets[i].actor.data.data.health.value - dmg\n                        targets[i].actor.update({ \"data.health.value\": newHealth });\n                    }   \n                }\n            },\n        },\n    });\n    newDialog.render(true);\n}","folder":null,"sort":0,"permission":{"default":0,"NdAjpNq64LjrLPB8":3},"flags":{"core":{"sourceId":"Macro.BMEMfgFnmtOPrfCV"}},"_id":"zPJoiXxdyeUNJmqd"}
